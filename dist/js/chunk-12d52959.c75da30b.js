(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12d52959"],{"06f1":function(t,a,e){},2496:function(t,a,e){"use strict";var n=e("06f1"),s=e.n(n);s.a},"8e44":function(t,a,e){"use strict";function n(t,a,e,n,s){return new Promise((function(o,i){t.$http.post(a,e,n).then((function(t){var a=URL.createObjectURL(new Blob([t.data],{type:"application/vnd.ms-excel"})),e=document.createElement("a");e.href=a,e.setAttribute("download",s),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(t){i(t)}))}))}function s(t,a,e,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"get";return new Promise((function(o,i){"get"==s?t.$http.get(a,e).then((function(t){var a=URL.createObjectURL(new Blob([t.data],{type:"application/pdf"})),e=document.createElement("a");e.href=a,e.setAttribute("download",n),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(t){i(t)})):t.$http.post(a,e).then((function(t){var a=URL.createObjectURL(new Blob([t.data],{type:"application/pdf"})),e=document.createElement("a");e.href=a,e.setAttribute("download",n),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(t){i(t)}))}))}function o(t){return new Promise((function(a,e){t.$http.get(localStorage.base_api+"po",{headers:{Authorization:"bearer "+localStorage.token}}).then((function(t){for(var a=[],e=[],n=0;n<t.data.length;n++){var s=new Date(t.data[n].date_line),o=new Date(s.setDate(s.getDate()-2));a.push({date:o,data:t.data[n],link:"po/detail/"+t.data[n].id})}for(var i=0;i<a.length;i++){var l=new Date,r=new Date(a[i].date);l==r&&e.push({date:a[i].date,data:a[i]})}return localStorage.setItem("notif",JSON.stringify(a)),a})).then((function(t){return a(t)})).catch((function(t){return e(t)}))}))}function i(t,a){return new Promise((function(e,n){var s=-1;Promise.all(t.map((function(t){return s++,fetch(t,a[s])}))).then((function(t){return Promise.all(t.map((function(t){return t.json()})))})).then((function(t){e(t)})).catch((function(t){return n(t)}))}))}function l(t,a,e,n){return new Promise((function(n,s){fetch(a,e).then((function(a){return 401==a.status?(t.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){t.$swal.close(),t.$store.dispatch("logout").then((function(){return t.$router.replace("/login")}))}),1500),!1):500==a.status?(t.$swal("Tidak bisa mengambil data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){t.$swal.close()}),1500),!1):a.json()})).then((function(t){return n(t)})).catch((function(t){return s(t)}))}))}function r(t,a,e){return new Promise((function(n,s){fetch(a,e).then((function(a){return 401==a.status?(t.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){t.$swal.close(),t.$store.dispatch("logout").then((function(){return t.$router.replace("/login")}))}),1500),!1):500==a.status?(t.$swal("Tidak bisa menghapus data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){t.$swal.close()}),1500),!1):a.json()})).then((function(t){return n(t)})).catch((function(t){return s(t)}))}))}e.d(a,"c",(function(){return n})),e.d(a,"d",(function(){return s})),e.d(a,"a",(function(){return o})),e.d(a,"e",(function(){return i})),e.d(a,"f",(function(){return l})),e.d(a,"b",(function(){return r}))},ba32:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("CCard",[e("CCardHeader",[e("b",[t._v("Data")]),t._v(" Purchase Order ")]),e("CCardBody",[e("CRow",{staticClass:"mx-auto d-flex justify-content-center"},[e("CCol",{staticClass:"mt-4",attrs:{sm:"8"}},[e("table",{staticClass:"table table-bordered table-striped"},[e("tr",[e("th",{staticClass:"w-50"},[t._v("Nama Sales")]),e("td",[t._v(t._s(t.po.nama_sales))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Nama Konsumen")]),e("td",[t._v(t._s(t.po.nama_konsumen))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Nama Kurir")]),e("td",[t._v(t._s(t.po.nama_kurir))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("No PO")]),e("td",[t._v(t._s(t.po.no_po))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Tanggal PO Masuk")]),e("td",[t._v(t._s(t.po.tgl_po_masuk))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Tanggal PO")]),e("td",[t._v(t._s(t.po.date))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Tanggal Pengiriman")]),e("td",[t._v(t._s(t.po.date_line))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("TOP")]),e("td",[t._v(t._s(t.po.jatuh_tempo))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Keterangan")]),e("td",[t._v(t._s(t.po.keterangan))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("No Surat Jalan")]),e("td",[t._v(t._s(t.po.no_surat_jalan))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("No Invoice")]),e("td",[t._v(t._s(t.po.no_invoice))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Catatan")]),e("td",[t._v(t._s(t.po.catatan))])]),e("tr",[e("th",{staticClass:"w-50"},[t._v("Status")]),4!=t.detailpo.status?e("td",[e("CSelect",{attrs:{horizontal:"",options:t.status},on:{"update:value":t.assignStatus},model:{value:t.detailpo.status,callback:function(a){t.$set(t.detailpo,"status",a)},expression:"detailpo.status"}})],1):e("td",[t._v(" Sukses ")])])])])],1),e("CRow",[e("CCol",{staticClass:"d-flex justify-content-end mt-4 mb-4",attrs:{sm:"10"}},[e("button",{staticClass:"btn btn-light",on:{click:t.updateStatus}},[e("i",{staticClass:"fa fa-edit mr-2"}),t._v(" "+t._s(t.label)+" ")])])],1),e("hr",{staticClass:"text-center w-75"}),e("br"),e("CRow",[e("CCol",{attrs:{sm:"12"}},[e("v-client-table",{staticClass:"m-4",attrs:{data:t.po_barang,columns:t.tableFields,options:t.tableOptions,id:"barang_tables"},scopedSlots:t._u([{key:"foto",fn:function(t){return e("div",{},[e("div",{staticClass:"mx-auto d-flex justify-content-center"},[e("img",{staticStyle:{"border-radius":"50%"},attrs:{src:"https://api.sabalkes.com/"+t.row.foto}})])])}}])}),e("div",{staticClass:"d-flex justify-content-end"},[e("div"),e("table",{staticClass:"table table-bordered table-striped m-2 mr-3 justify-content-end w-50"},[e("tr",[e("th",{staticClass:"w-50 text-right"},[t._v("Sub Total")]),e("td",[t._v(t._s(t.po.sub_total))])]),e("tr",[e("th",{staticClass:"w-50 text-right"},[t._v("Discount")]),e("td",[t._v(t._s(t.po.disc))])]),e("tr",[e("th",{staticClass:"w-50 text-right"},[t._v("Tax Rate (%)")]),e("td",[t._v(t._s(t.po.tax_rate))])]),e("tr",[e("th",{staticClass:"w-50 text-right"},[t._v("Sales Fee")]),e("td",[t._v(t._s(t.po.sales_fee))])]),e("tr",[e("th",{staticClass:"w-50 text-right"},[t._v("Other Cost")]),e("td",[t._v(t._s(t.po.other))])]),e("tr",[e("th",{staticClass:"w-50 text-right"},[t._v("Grand Total")]),e("td",[t._v(t._s(t.po.sub_total-t.po.disc+t.po.tax_rate+t.po.sales_fee+t.po.other))])])])])],1)],1)],1)],1)],1)},s=[],o=e("8e44"),i={name:"DetailPO",data:function(){return{status:[],label:"Update Status PO",data:this.$store.getters.userData,tableFields:["no","foto","kode_barang","nama_barang","spesifikasi","disc","tax","total"],tableOptions:{perPage:10,pagination:{chunk:10,dropdown:!1,edge:!0,nav:"fixed"},headings:{no:"No",foto:"Foto",kode_barang:"Kode Barang",nama_barang:"Nama Barang",spesifikasi:"Spesifikasi Barang",disc:"Diskon",tax:"Tax",total:"Total"},sortable:["nama_barang"],filterable:["nama_barang","kode_barang","spesifikasi","no","disc","tax","total"],columnsClasses:{no:"text-center align-middle",foto:"text-center align-middle",kode_barang:"align-middle",nama_barang:"align-middle",spesifikasi:"align-middle",disc:"align-middle",tax:"align-middle",total:"align-middle"}},po_barang:[],info_po:[],info_barang_po:[],detailpo:{status:2,level:0},po:{nama_sales:null,nama_konsumen:null,nama_kurir:null,no_po:null,date:null,date_line:null,jatuh_tempo:null,keterangan:null,tax_rate:null,sales_fee:null,other:null,no_surat_jalan:null,no_invoice:null,status:null,catatan:null,tgl_po_masuk:null,sub_total:0,sales_tax_rate:0,disc:0,tax:0,grand_total:0}}},methods:{assignStatus:function(t){this.detailpo.status=t},updateStatus:function(){var t=this;this.label="Loading...",this.$http.post(localStorage.base_api+"po/edit/"+this.$route.params.id,this.detailpo,{headers:{Authorization:"bearer "+localStorage.token},redirect:"follow"}).then((function(){t.label="Update Status PO",t.$swal("Status berhasil diupdate","Mohon tunggu sebentar...","success"),setTimeout((function(){return t.$swal.close()}),1500),t.getData()})).catch((function(a){return t.label="Update Status PO",console.error(a),t.$swal("Status gagal diupdate","Hubungi pengembangnya...","error"),setTimeout((function(){return t.$swal.close}),1500),!1}))},getData:function(){var t=this;Object(o["f"])(this,localStorage.base_api+"po/"+this.$route.params.id,{method:"POST",headers:{Authorization:"bearer "+localStorage.token},redirect:"follow"},"post").then((function(a){console.log(a),t.po=a,t.po.sub_total=0,t.po.sales_tax_rate=0,t.po.disc=0,t.po.tax=0,t.po.grand_total=0,t.detailpo.status=a.status})).catch((function(t){return console.error(t),!1}))},getDataTable:function(){var t=this;return new Promise((function(a,e){Object(o["f"])(t,localStorage.base_api+"order/barang/po/detail/"+t.$route.params.id,{method:"post",headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(e){var n=[];console.warn("Order Barang"),t.info_po=e,t.po.sub_total=0,t.po.disc=0,t.po.tax=0,t.po.sales_tax_rate=0,t.po.grand_total=0,t.info_po.forEach((function(a,e){Object(o["f"])(t,localStorage.base_api+"barang/"+a.id_barang,{method:"POST",headers:{Authorization:"bearer "+localStorage.token}},"POST").then((function(s){var o=a.qty*s.harga_jual,i=a.disc,l=a.tax;n.push({no:++e,total:o,disc:i,tax:l,foto:localStorage.base_uri+s.foto,kode_barang:s.kode_barang,nama_barang:s.nama_barang,spesifikasi:s.spesifikasi}),t.po.sub_total+=parseInt(o),t.po.disc+=parseInt(s.harga_jual*a.qty*(i/100)),t.po.tax_rate+=parseInt(s.harga_jual*a.qty*(l/100))}))})),a(n)})).catch((function(t){e(t)}))}))}},filters:{formatMoney:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:",";try{a=Math.abs(a),a=isNaN(a)?2:a;var s=t<0?"-":"",o=parseInt(t=Math.abs(Number(t)||0).toFixed(a)).toString(),i=o.length>3?o.length%3:0;return s+(i?o.substr(0,i)+n:"")+o.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+n)+(a?e+Math.abs(t-o).toFixed(a).slice(2):"")}catch(l){console.log(l)}}},created:function(){var t=this;5!=localStorage.level&&4!=localStorage.level||this.$router.push("/"),this.getData(),this.getDataTable().then((function(a){t.po_barang=a})),this.data=JSON.parse(localStorage.user),6==this.data.level?(this.status=[{label:"Request",value:1},{label:"Proses",value:2},{label:"Batal",value:5}],this.detailpo.level=6):3==this.data.level?(this.status=[{label:"Request",value:1},{label:"Pengiriman",value:3},{label:"Selesai",value:4}],this.detailpo.level=3):(this.status=[{label:"Request",value:1},{label:"Proses",value:2},{label:"Pengiriman",value:3},{label:"Selesai",value:4},{label:"Batal",value:5}],this.detailpo.level=this.data.level)}},l=i,r=(e("2496"),e("2877")),u=Object(r["a"])(l,n,s,!1,null,null,null);a["default"]=u.exports}}]);
//# sourceMappingURL=chunk-12d52959.c75da30b.js.map