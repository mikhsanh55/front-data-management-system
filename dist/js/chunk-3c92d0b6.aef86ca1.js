(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c92d0b6"],{"8e44":function(a,t,e){"use strict";function n(a,t,e,n,r){return new Promise((function(o,s){a.$http.post(t,e,n).then((function(a){var t=URL.createObjectURL(new Blob([a.data],{type:"application/vnd.ms-excel"})),e=document.createElement("a");e.href=t,e.setAttribute("download",r),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(a){s(a)}))}))}function r(a,t,e,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"get";return new Promise((function(o,s){"get"==r?a.$http.get(t,e).then((function(a){var t=URL.createObjectURL(new Blob([a.data],{type:"application/pdf"})),e=document.createElement("a");e.href=t,e.setAttribute("download",n),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(a){s(a)})):a.$http.post(t,e).then((function(a){var t=URL.createObjectURL(new Blob([a.data],{type:"application/pdf"})),e=document.createElement("a");e.href=t,e.setAttribute("download",n),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(a){s(a)}))}))}function o(a){return new Promise((function(t,e){a.$http.get(localStorage.base_api+"po",{headers:{Authorization:"bearer "+localStorage.token}}).then((function(a){for(var t=[],e=0;e<a.data.length;e++){var n=(new Date).setHours(0,0,0,0),r=new Date(a.data[e].date_line);n=new Date(n),r=new Date(r.setDate(r.getDate()-2)),n.getTime()==r.getTime()&&t.push({date:r,data:a.data[e],link:"po/detail/"+a.data[e].id})}return localStorage.setItem("notif",JSON.stringify(t)),t})).then((function(a){return t(a)})).catch((function(a){return e(a)}))}))}function s(a,t){return new Promise((function(e,n){var r=-1;Promise.all(a.map((function(a){return r++,fetch(a,t[r])}))).then((function(a){return Promise.all(a.map((function(a){return a.json()})))})).then((function(a){e(a)})).catch((function(a){return n(a)}))}))}function i(a,t,e,n){return new Promise((function(n,r){fetch(t,e).then((function(t){return 401==t.status?(a.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){a.$swal.close(),a.$store.dispatch("logout").then((function(){return a.$router.replace("/login")}))}),1500),!1):500==t.status?(a.$swal("Tidak bisa mengambil data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){a.$swal.close()}),1500),!1):t.json()})).then((function(a){return n(a)})).catch((function(a){return r(a)}))}))}function l(a,t,e){return new Promise((function(n,r){fetch(t,e).then((function(t){return 401==t.status?(a.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){a.$swal.close(),a.$store.dispatch("logout").then((function(){return a.$router.replace("/login")}))}),1500),!1):500==t.status?(a.$swal("Tidak bisa menghapus data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){a.$swal.close()}),1500),!1):t.json()})).then((function(a){return n(a)})).catch((function(a){return r(a)}))}))}e.d(t,"c",(function(){return n})),e.d(t,"d",(function(){return r})),e.d(t,"a",(function(){return o})),e.d(t,"e",(function(){return s})),e.d(t,"f",(function(){return i})),e.d(t,"b",(function(){return l}))},ff1b:function(a,t,e){"use strict";e.r(t);var n=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",[e("CCard",[e("CCardHeader",[e("p",[e("b",[a._v("Tambah")]),a._v(" User")])]),e("CCardBody",[e("CForm",{staticClass:"mt-4"},[e("CRow",{staticClass:"mx-auto d-flex justify-content-center"},[e("CCol",{attrs:{sm:"8"}},[e("p",{directives:[{name:"show",rawName:"v-show",value:1==a.validMsg,expression:"validMsg == true"}],staticClass:"alert alert-success"},[e("small",[a._v("Penambahan User berhasil!")])]),e("CDataList",{attrs:{label:"Karyawan",placeholder:"Pilih Karyawan",idList:"karyawan",labelClasses:"text-dark",listClasses:"form-control",options:a.karyawan},on:{"update:value":a.assignKaryawan}}),e("CInput",{attrs:{type:"email",description:a.validator.email_msg,"is-valid":a.validator.email,autocomplete:"email",label:"Email",horizontal:"",placeholder:"Masukan Email",readonly:""},on:{input:function(t){a.user.email.length<1?a.validator.email=!1:a.validator.email=!0}},model:{value:a.user.email,callback:function(t){a.$set(a.user,"email",t)},expression:"user.email"}}),e("CInput",{attrs:{type:"password",description:a.validator.password_msg,"is-valid":a.validator.password,autocomplete:"password",label:"Password",horizontal:"",placeholder:"Masukan Password"},on:{input:function(t){a.user.password.length<1?a.validator.password=!1:a.validator.password=!0}},model:{value:a.user.password,callback:function(t){a.$set(a.user,"password",t)},expression:"user.password"}}),e("CSelect",{attrs:{label:"Jabatan",horizontal:"",options:a.jabatan,readonly:""},on:{"update:value":a.assignJabatan},model:{value:a.user.level,callback:function(t){a.$set(a.user,"level",t)},expression:"user.level"}})],1)],1)],1)],1),e("CCardFooter",{staticClass:"d-flex justify-content-center mt-4"},[e("CButton",{attrs:{type:"submit",color:"primary"},on:{click:function(t){return t.preventDefault(),a.addUser(t)}}},[e("i",{staticClass:"fa fa-plus mr-1"}),a._v(a._s(a.label)+" ")])],1)],1)],1)},r=[],o=(e("8e44"),{name:"AddUser",data:function(){return{label:"Tambah User",validator:{email:null,email_msg:null,password:null,password_msg:null},user:{id_karyawan:null,email:null,password:null,level:null},karyawan:[],data_karyawan:[],jabatan:[],validMsg:!1,errors:[]}},methods:{getJabatan:function(){var a=this;this.jabatan.push({value:"000",label:"Pilih Jabatan"}),this.$http.get(localStorage.base_api+"jabatan",{headers:{Authorization:"bearer "+localStorage.token}}).then((function(t){for(var e=0;e<t.data.length;e++){var n={};n.value=t.data[e].id,n.label=t.data[e].nama,a.jabatan.push(n)}})).catch((function(a){return alert("Maaf lagi ada error sedikit :D"),console.error(a.response),!1}))},getKaryawan:function(){var a=this;this.karyawan.push({value:"000",label:"Pilih Karyawan"});var t=new Headers;t.append("Authorization","bearer "+localStorage.getItem("token"));var e={method:"GET",headers:t,redirect:"follow"};fetch(localStorage.base_api+"karyawan",e).then((function(a){return a.json()})).then((function(t){a.data_karyawan=t;for(var e=0;e<t.length;e++){var n={};n.value=t[e].id,n.label=t[e].nama_karyawan,a.karyawan.push(n)}})).then((function(){a.getJabatan()})).catch((function(a){return alert("Maaf lagi ada error sedikit :D"),console.error(a),!1}))},assignKaryawan:function(a){var t=this;this.data_karyawan.forEach((function(t,e){a===t.nama_karyawan&&(this.user.email=t.email,this.user.id_karyawan=t.id)})),fetch(localStorage.base_api+"karyawan/"+this.user.id_karyawan,{method:"POST",headers:{Authorization:"bearer "+localStorage.token}}).then((function(a){return a.json()})).then((function(a){t.user.level=a.id_jabatan}))},assignJabatan:function(a){this.user.level=a},addUser:function(){var a=this;this.errors=[],this.user.email||(this.validator.email=!1,this.validator.email_msg="Harap isi email karyawan",this.errors.push("email karyawan kosong")),this.user.password||(this.validator.password=!1,this.validator.password_msg="Harap isi password karyawan",this.errors.push("password karyawan kosong")),this.user.id_karyawan&&"000"!=this.user.id_karyawan||(this.errors.push("Harap pilih karyawan"),this.$swal("Harap pilih karyawan","","warning"),setTimeout((function(){return a.$swal.close()}),1500)),this.errors.length||(console.log(this.user),this.label="Loading...",this.$http.post(localStorage.base_api+"user",this.user,{headers:{Authorization:"bearer "+localStorage.getItem("token")},redirect:"follow"}).then((function(t){a.label="Tambah User",a.$swal(t.data.message,"Mohon tunggu sebentar...","success"),setTimeout((function(){a.$swal.close(),a.$router.push("/user")}),1500)})).catch((function(t){if(console.warn(t.response),401!=t.response.status){for(var e in a.label="Tambah User",t.response.data.errmsg)a.$swal(t.response.data.errmsg[e][0],"hubungi pengembangnya yah","error"),setTimeout((function(){a.$swal.close()}),1500);return!1}a.$store.dispatch("logout").then((function(){var t=window.location.href;return t=t.split("/"),localStorage.setItem("prevPath",t[t.length-1]),a.$swal("Sesi Login kamu udah habis","login lagi yah","warning"),setTimeout((function(){a.$swal.close(),a.$router.replace({path:"/login"})}),1500),!1})).catch((function(t){return console.log(t),a.$swal("Tidak bisa menambah data","hubungi pengembangnya yah","error"),setTimeout((function(){a.$swal.close()}),1500),!1}))})))}},created:function(){1!=localStorage.level&&2!=localStorage.level&&this.$router.push("/"),this.getKaryawan()}}),s=o,i=e("2877"),l=Object(i["a"])(s,n,r,!1,null,null,null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-3c92d0b6.aef86ca1.js.map