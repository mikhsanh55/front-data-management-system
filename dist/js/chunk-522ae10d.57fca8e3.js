(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-522ae10d"],{"188c":function(a,t,n){"use strict";t["a"]={methods:{toRupiah:function(a){var t=a.toString().replace(/[^, \d]/g,"").toString(),n=t.split(","),e=n[0].length%3,r=n[0].substr(0,e),o=n[0].substr(e).match(/\d{3}/gi),i="";return o&&null!=o.length&&(i=e?".":"",r+=i+o.join(".")),r=void 0!=n[1]?r+","+n[1]:r,r},toFloatRupiah:function(a){a=a.split(".");for(var t=0;t<a.length;t++)a[t].includes(",")&&(a[t]=a[t].replace(/,/g,"."));return a.join("")}}}},"8e44":function(a,t,n){"use strict";function e(a,t,n,e,r){return new Promise((function(o,i){a.$http.post(t,n,e).then((function(a){var t=URL.createObjectURL(new Blob([a.data],{type:"application/vnd.ms-excel"})),n=document.createElement("a");n.href=t,n.setAttribute("download",r),document.body.appendChild(n),n.click()})).then((function(){o()})).catch((function(a){i(a)}))}))}function r(a,t,n,e){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"get",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return new Promise((function(i,s){"get"==r?a.$http.get(t,n).then((function(a){var t=URL.createObjectURL(new Blob([a.data],{type:"application/pdf"})),n=document.createElement("a");n.href=t,n.setAttribute("download",e),document.body.appendChild(n),n.click()})).then((function(){i()})).catch((function(a){s(a)})):a.$http.post(t,o,n).then((function(a){var t=URL.createObjectURL(new Blob([a.data],{type:"application/pdf"})),n=document.createElement("a");n.href=t,n.setAttribute("download",e),document.body.appendChild(n),n.click()})).then((function(){i()})).catch((function(a){s(a)}))}))}function o(a){return new Promise((function(t,n){s(a,localStorage.base_api+"po",{method:"post",headers:{Authorization:"bearer "+localStorage.getItem("token")},redirect:"follow"}).then((function(a){for(var t=[],n=0;n<a.length;n++){var e=(new Date).setHours(0,0,0,0),r=new Date(a[n].date_line);e=new Date(e),r=new Date(r.setDate(r.getDate()-2)),e.getTime()==r.getTime()&&t.push({date:r,data:a[n],link:"po/detail/"+a[n].id})}return localStorage.setItem("notif",JSON.stringify(t)),t})).then((function(a){return t(a)})).catch((function(a){return n(a)}))}))}function i(a,t){return new Promise((function(n,e){var r=-1;Promise.all(a.map((function(a){return r++,fetch(a,t[r])}))).then((function(a){return Promise.all(a.map((function(a){return a.json()})))})).then((function(a){n(a)})).catch((function(a){return e(a)}))}))}function s(a,t,n,e){return new Promise((function(e,r){fetch(t,n).then((function(t){return 401==t.status?(a.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){a.$swal.close(),a.$store.dispatch("logout").then((function(){return a.$router.replace("/login")}))}),1500),!1):500==t.status?(a.$swal("Tidak bisa mengambil data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){a.$swal.close()}),1500),!1):t.json()})).then((function(a){return e(a)})).catch((function(a){return r(a)}))}))}function l(a,t,n){return new Promise((function(e,r){fetch(t,n).then((function(t){return 401==t.status?(a.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){a.$swal.close(),a.$store.dispatch("logout").then((function(){return a.$router.replace("/login")}))}),1500),!1):500==t.status?(a.$swal("Tidak bisa menghapus data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){a.$swal.close()}),1500),!1):t.json()})).then((function(a){return e(a)})).catch((function(a){return r(a)}))}))}n.d(t,"c",(function(){return e})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l}))},d8aa:function(a,t,n){"use strict";var e=n("e65a"),r=n.n(e);r.a},e65a:function(a,t,n){},f88f:function(a,t,n){"use strict";n.r(t);var e=function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("div",[n("CRow",[n("CCol",{attrs:{sm:"12"}},[n("CCard",[n("CCardHeader",[n("b",[a._v("Order")]),a._v(" Barang ")]),n("CCardBody",[n("CForm",{staticClass:"mt-4"},[n("CRow",{staticClass:"mx-auto d-flex justify-content-center"},[n("CCol",{attrs:{md:"8",sm:"12"}},[n("CSelect",{attrs:{placeholder:"Pilih Barang",label:a.labelBarang,horizontal:"",options:a.barang},on:{"update:value":a.assignNamaBarang},model:{value:a.rpo.id_barang,callback:function(t){a.$set(a.rpo,"id_barang",t)},expression:"rpo.id_barang"}}),n("CTextarea",{attrs:{label:"Spesifikasi Barang",description:a.validator.spesifikasi_barang_msg,"is-valid":a.validator.spesifikasi_barang,horizontal:"",rows:"3",readonly:""},on:{input:function(t){a.rpo.spesifikasi_barang.length<1?a.validator.spesifikasi_barang=!1:a.validator.spesifikasi_barang=!0}},model:{value:a.rpo.spesifikasi_barang,callback:function(t){a.$set(a.rpo,"spesifikasi_barang",t)},expression:"rpo.spesifikasi_barang"}}),n("CInput",{attrs:{type:"number",description:a.validator.qty_msg,"is-valid":a.validator.qty,autocomplete:"qty",label:"Quantity",horizontal:"",placeholder:"Masukan Quantity"},model:{value:a.rpo.qty,callback:function(t){a.$set(a.rpo,"qty",t)},expression:"rpo.qty"}}),n("CInput",{attrs:{type:"text",label:"Satuan",placeholder:"Masukan Satuan",horizontal:"",readonly:""},model:{value:a.rpo.satuan,callback:function(t){a.$set(a.rpo,"satuan",t)},expression:"rpo.satuan"}}),n("CInput",{attrs:{type:"text",description:a.validator.harga_jual_msg,"is-valid":a.validator.harga_jual,autocomplete:"harga_jual",label:"Harga Jual Satuan",horizontal:"",placeholder:"Masukan Harga Jual Satuan"},model:{value:a.rpo.harga_jual,callback:function(t){a.$set(a.rpo,"harga_jual",t)},expression:"rpo.harga_jual"}}),n("CInput",{attrs:{type:"number",description:a.validator.tax_msg,"is-valid":a.validator.tax,autocomplete:"tax",label:"Pajak (%)",horizontal:"",placeholder:"Masukan Tax Rate"},on:{input:function(t){a.rpo.tax.length<1?a.validator.tax=!1:a.validator.tax=!0}},model:{value:a.rpo.tax,callback:function(t){a.$set(a.rpo,"tax",t)},expression:"rpo.tax"}}),n("CInput",{attrs:{type:"number",description:a.validator.disc_msg,"is-valid":a.validator.disc,autocomplete:"disc",label:"Disc %",horizontal:"",placeholder:"Masukan disc"},on:{input:function(t){a.rpo.disc.length<1?a.validator.disc=!1:a.validator.disc=!0}},model:{value:a.rpo.disc,callback:function(t){a.$set(a.rpo,"disc",t)},expression:"rpo.disc"}}),n("div",{staticClass:"d-flex justify-content-end mt-4"},[n("button",{staticClass:"btn btn-primary",on:{click:function(t){return t.preventDefault(),a.addToTable(t)}}},[n("i",{staticClass:"fa fa-plus mr-2"}),a._v(a._s(a.label))])])],1),n("CCol",{attrs:{md:"2",sm:"12"}},[n("div",[n("button",{staticClass:"btn btn-success",on:{click:function(t){t.preventDefault(),a.openBarangModal=!0}}},[n("i",{staticClass:"fa fa-search mr-1"}),a._v("Cari Barang")])])])],1)],1),n("br"),n("hr",{staticClass:"text-center w-75"}),n("br"),n("CRow",[n("CCol",{attrs:{sm:"12"}},[n("v-client-table",{staticClass:"m-4",attrs:{data:a.order_barang,columns:a.tableFields,options:a.tableOptions,id:"request-table"},scopedSlots:a._u([{key:"aksi",fn:function(t){return n("div",{},[n("button",{staticClass:"btn btn-secondary text-danger m-1",on:{click:function(n){return a.deleteFromTable(t.row.id)}}},[n("i",{staticClass:"fa fa-trash"})])])}}])}),n("div",{staticClass:"d-flex justify-content-end"},[n("div"),n("table",{staticClass:"table table-bordered table-striped m-2 mr-3 justify-content-end w-50"},[n("tr",[n("th",{staticClass:"w-50 text-right"},[a._v("Sub Total")]),n("td",[a._v(a._s(a._f("formatRupiah")(a.rpo.sub_total)))])]),n("tr",[n("th",{staticClass:"w-50 text-right"},[a._v("Discount")]),n("td",[a._v(a._s(a.rpo.disc))])]),n("tr",[n("th",{staticClass:"w-50 text-right"},[a._v("Tax Rate (%)")]),n("td",[a._v(a._s(a.rpo.tax_rate))])]),n("tr",[n("th",{staticClass:"w-50 text-right"},[a._v("Sales Fee")]),n("td",[a._v(a._s(a._f("formatRupiah")(a.rpo.sales_fee)))])]),n("tr",[n("th",{staticClass:"w-50 text-right"},[a._v("Other Cost")]),n("td",[a._v(a._s(a._f("formatRupiah")(a.rpo.other)))])]),n("tr",[n("th",{staticClass:"w-50 text-right"},[a._v("Grand Total")]),n("td",[a._v(a._s(a._f("formatRupiah")(a.rpo.sub_total-a.rpo.disc+a.rpo.tax_rate+a.rpo.sales_fee+a.rpo.other)))])])])])],1)],1)],1),n("CCardFooter",{staticClass:"m-4 d-flex justify-content-end"},[n("router-link",{staticClass:"btn btn-primary",attrs:{to:"/po",disabled:a.isEmpty}},[n("i",{staticClass:"fa fa-cart-plus mr-2"}),a._v(" Selesai ")])],1)],1)],1)],1),n("CModal",{attrs:{show:a.openBarangModal,"no-close-on-backdrop":!0,title:"Cari Barang",size:"lg",color:"dark"},on:{"update:show":function(t){a.openBarangModal=t}},scopedSlots:a._u([{key:"header",fn:function(){return[n("h6",{staticClass:"modal-title"},[a._v("Cari Barang")]),n("CButtonClose",{staticClass:"text-white",on:{click:function(t){a.openBarangModal=!1}}})]},proxy:!0}])},[n("CInput",{staticClass:"m-4",attrs:{type:"text",description:"Ketik minimal 3 huruf untuk melihat hasil",label:"Cari Barang",horizontal:"",placeholder:"Masukan nama barang"},model:{value:a.barangKeyword,callback:function(t){a.barangKeyword=t},expression:"barangKeyword"}}),n("v-client-table",{staticClass:"m-4",attrs:{data:a.searchBarang,columns:a.searchBarangFields,options:a.searchBarangOptions,id:"search-barang-table"},scopedSlots:a._u([{key:"aksi",fn:function(t){return n("div",{},[n("button",{staticClass:"btn btn-primary",on:{click:function(n){return a.selectBarang(t.row.id,t.row.nama_barang)}}},[a._v("Pilih")])])}}])})],1)],1)},r=[],o=n("188c"),i=n("8e44");function s(a){return s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},s(a)}function l(a,t,n){return t in a?Object.defineProperty(a,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[t]=n,a}var u={name:"OrderPO",mixins:[o["a"]],data:function(){var a;return{barangKeyword:null,openBarangModal:!1,labelBarang:"Pilih Barang",isEmpty:!0,label:"Tambah",errors:[],searchBarangFields:["kode_barang","nama_barang","stock","satuan","aksi"],searchBarangOptions:{headings:{kode_barang:"Kode",nama_barang:"Nama",stock:"Stok",satuan:"Satuan",aksi:"Aksi"},sortable:["kode_barang","nama_barang","stock","satuan"],filterable:["kode_barang","nama_barang","stock","satuan"],columnsClasses:{kode_barang:"align-middle",nama_barang:"align-middle",stock:"text-center align-middle",satuan:"text-center align-middle",aksi:"text-center align-middle"}},tableFields:["no","kode_barang","nama_barang","spesifikasi_barang","harga_jual","qty","tax","disc","total","aksi"],tableOptions:{perPage:10,pagination:{chunk:10,dropdown:!1,edge:!0,nav:"fixed"},headings:{no:"No",kode_barang:"Kode Barang",nama_barang:"Nama Barang",spesifikasi_barang:"Spesifikasi",harga_jual:"Harga Jual",qty:"qty",tax:"Pajak %",disc:"disc %",total:"Total",aksi:"Aksi"},sortable:["no","kode_barang","nama_barang","qty"],filterable:["no","kode_barang","nama_barang","spesifikasi_barang","harga_jual","qty","tax","disc","total"],columnsClasses:{no:"text-center align-middle",kode_barang:"align-middle",nama_barang:"align-middle",spesifikasi_barang:"align-middle",harga_jual:"text-center align-middle",qty:"text-center align-middle",tax:"text-center align-middle",disc:"text-center align-middle",total:"text-center align-middle",aksi:"text-center align-middle"}},searchBarang:[],barang:[],barangs:[],validator:{harga_jual:null,harga_jual_msg:null,spesifikasi_barang:null,spesifikasi_barang_msg:null,qty:null,qty_msg:null,tanggal:null,tanggal_msg:null},rpo:(a={id_po:null,id_barang:1,nama_barang:null,spesifikasi_barang:null,qty:0,tanggal:null,harga_jual:null,satuan:null,status:1,kode_barang:null,tax_rate:0,total:0,sub_total:0,sales_fee:0,other:0},l(a,"sub_total",0),l(a,"sales_tax_rate",0),l(a,"disc",0),l(a,"tax",0),l(a,"grand_total",0),a),order_barang:[]}},watch:{"rpo.harga_jual":function(a){this.rpo.harga_jual=this.toRupiah(a)},barangKeyword:function(a){if(a.length>=3&&(null!=a||""!=a)){var t=this.barangs.filter((function(t){return t.nama_barang.toLowerCase().indexOf(a)>-1}));t.length>0?this.searchBarang=t:this.searchBarang=[]}}},filters:{formatRupiah:function(a){var t=a.toString().replace(/[^, \d]/g,"").toString(),n=t.split(","),e=n[0].length%3,r=n[0].substr(0,e),o=n[0].substr(e).match(/\d{3}/gi),i="";return o&&null!=o.length&&(i=e?".":"",r+=i+o.join(".")),r=void 0!=n[1]?r+","+n[1]:r,r}},methods:{selectBarang:function(a,t){this.assignNamaBarang(a,t),this.openBarangModal=!1},assignNamaBarang:function(a,t){this.rpo.id_barang=a,this.rpo.nama_barang="object"==s(t)?t.target.selectedOptions[0].innerHTML:t;for(var n=0;n<this.barangs.length;n++)this.barangs[n].id==a&&(this.rpo.satuan=this.barangs[n].satuan,this.rpo.harga_jual=this.barangs[n].harga_jual,this.rpo.spesifikasi_barang=this.barangs[n].spesifikasi,this.rpo.kode_barang=this.barangs[n].kode_barang)},getRequest:function(a){var t=this;return new Promise((function(n,e){t.$http.post(a,{headers:{Authorization:"bearer "+localStorage.getItem("token")},redirect:"follow"}).then((function(a){n(a.data)})).catch((function(a){return alert("Ada sedikit error saat ambil data!"),console.log(a),e(a),!1}))}))},deleteFromTable:function(a){var t=this;this.$swal("Mohon tunggu","","info"),this.$http.delete(localStorage.base_api+"order/barang/po/"+a,{headers:{Authorization:"bearer "+localStorage.token}}).then((function(){t.barang=[],t.order_barang=[],t.fetchAll(),t.getDataTable(),t.$swal.close()})).catch((function(a){t.$swal("Tidak bisa menghapus data","mohon hubungi pengembangnya","error"),console.error(a)}))},addToTable:function(){var a=this;if(this.errors=[],this.rpo.spesifikasi_barang||(this.validator.spesifikasi_barang=!1,this.validator.spesifikasi_barang_msg="Harap isi Spesifikasi barang",this.errors.push("spesifikasi_barang kosong")),this.rpo.qty||(this.validator.qty=!1,this.validator.qty_msg="Harap isi qty barang",this.errors.push("qty kosong")),this.errors.length)return console.log(this.errors),window.scrollBy({top:-500,left:0,behavior:"smooth"}),!1;this.rpo.harga_jual=this.toFloatRupiah(this.rpo.harga_jual),this.label="Loading...",this.rpo.id_po=this.$route.params.id,this.rpo.total=Math.round(this.rpo.harga_jual*this.rpo.qty+this.rpo.tax/100-this.rpo.disc/100*(this.rpo.harga_jual*this.rpo.qty)),this.$http.post(localStorage.base_api+"order/barang/po",this.rpo,{headers:{Authorization:"bearer "+localStorage.token}}).then((function(t){var n;a.order_barang=[],a.rpo=(n={id_po:null,id_barang:1,nama_barang:null,spesifikasi_barang:null,qty:0,tanggal:null,satuan:null,harga_jual:null,status:1,kode_barang:null,tax_rate:0,total:0,sub_total:0,sales_fee:0,other:0},l(n,"sub_total",0),l(n,"sales_tax_rate",0),l(n,"disc",0),l(n,"tax",0),l(n,"grand_total",0),n),a.label="Tambah",a.getDataTable(),window.scrollBy({top:1e3,left:0,behavior:"smooth"})})).catch((function(t){return a.label="Tambah",t.response&&(console.error(t),a.$swal(t.response.data.message,"","warning"),a.getDataTable(),setTimeout((function(){a.$swal.close()}),1500)),console.error(t),!1}))},fetchAll:function(){var a=this,t=this;Object(i["f"])(this,localStorage.base_api+"barang",{method:"post",headers:{Authorization:"bearer "+localStorage.getItem("token")},redirect:"follow"}).then((function(n){if(n.length<1)return alert("Mohon maaf belum ada barang masuk untuk saat ini, silahkan tambah dulu barangnya yah"),!1;a.barangs=n,n.forEach((function(a,n){var e={};e.label="".concat(a.nama_vendor," - ").concat(a.nama_barang),e.value=a.id,t.barang.push(e)}))})).catch((function(t){return console.error(t),a.$swal("Tidak bisa mengambil data barang","Mohon hubungi pengembangnya","error"),setTimeout((function(){return a.$swal.close()}),1500),!1}))},getDataTable:function(){var a=this;this.order_barang=[],Object(i["f"])(this,localStorage.base_api+"order/barang/po/detail/"+this.$route.params.id,{method:"post",headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(t){t.forEach((function(t,n){var e={id:t.id,no:++n,qty:t.qty,tax:t.tax,disc:t.disc,kode_barang:t.kode_barang,nama_barang:t.nama_barang,spesifikasi_barang:t.spesifikasi,harga_jual:t.harga_jual,total:t.harga_jual*t.qty};a.order_barang.push(e),a.rpo.sub_total+=parseInt(t.harga_jual*t.qty),a.rpo.disc+=parseInt(t.harga_jual*t.qty*(t.disc/100)),a.rpo.tax_rate+=parseInt(t.harga_jual*t.qty*(t.tax/100))}))})).catch((function(t){return console.error(t),a.$swal("Tidak bisa mengambil data barang","Mohon hubungi pengembangnya","error"),setTimeout((function(){return a.$swal.close()}),1500),!1}))}},created:function(){5!=localStorage.level&&4!=localStorage.level||this.$router.push("/"),this.fetchAll(),this.getDataTable()}},c=u,d=(n("d8aa"),n("2877")),g=Object(d["a"])(c,e,r,!1,null,null,null);t["default"]=g.exports}}]);
//# sourceMappingURL=chunk-522ae10d.57fca8e3.js.map