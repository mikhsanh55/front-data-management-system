(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-97571430"],{"8a05":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("CCard",[t("CCardHeader",[t("p",[t("b",[e._v("Edit")]),e._v(" User")])]),t("CCardBody",[t("CForm",{staticClass:"mt-4"},[t("CRow",{staticClass:"mx-auto d-flex justify-content-center"},[t("CCol",{attrs:{sm:"8"}},[t("p",{directives:[{name:"show",rawName:"v-show",value:1==e.validMsg,expression:"validMsg == true"}],staticClass:"alert alert-success"},[t("small",[e._v("Update Data User berhasil!")])]),t("CSelect",{attrs:{description:"Masukan Nama Karyawan",label:"Nama Karyawan",horizontal:"",options:e.karyawan},on:{"update:value":e.assignKaryawan},model:{value:e.user.id,callback:function(a){e.$set(e.user,"id",a)},expression:"user.id"}}),t("CInput",{attrs:{type:"email",description:e.validator.email_msg,"is-valid":e.validator.email,autocomplete:"email",label:"Email",horizontal:"",placeholder:"Masukan Email",readonly:""},on:{input:function(a){e.karyawan.email.length<1?e.validator.email=!1:e.validator.email=!0}},model:{value:e.user.email,callback:function(a){e.$set(e.user,"email",a)},expression:"user.email"}}),t("CSelect",{attrs:{label:"Jabatan",horizontal:"",options:e.jabatan,readonly:""},on:{"update:value":e.assignJabatan},model:{value:e.user.id_level,callback:function(a){e.$set(e.user,"id_level",a)},expression:"user.id_level"}})],1)],1)],1)],1),t("CCardFooter",{staticClass:"d-flex justify-content-center mt-4"},[t("CButton",{attrs:{type:"submit",color:"light"},on:{click:function(a){return a.preventDefault(),e.updateUser(a)}}},[t("i",{staticClass:"fa fa-edit mr-1"}),e._v(e._s(e.label)+" ")])],1)],1)],1)},r=[],o=t("8e44"),i={name:"EditUser",data:function(){return{label:"Simpan Perubahan",validator:{email:null,email_msg:null},user:{id:1,id_karyawan:1,nama:null,email:null,username:null,id_level:null},jabatan:[],karyawan:[],data_karyawan:[],validMsg:!1,errors:[]}},methods:{getJabatan:function(){var e=this;Object(o["g"])(this,localStorage.base_api+"jabatan",{headers:{Authorization:"bearer "+localStorage.token}}).then((function(a){for(var t=0;t<a.length;t++){var n={};n.value=a[t].id,n.label=a[t].nama,e.jabatan.push(n)}console.log(e.jabatan)})).then((function(){e.getData()})).catch((function(a){return e.label="Tambah Karyawan",console.error(a),!1}))},getKaryawan:function(){var e=this,a=new Headers;a.append("Authorization","bearer "+localStorage.getItem("token"));var t={method:"GET",headers:a,redirect:"follow"};Object(o["g"])(this,localStorage.base_api+"karyawan",t).then((function(a){e.data_karyawan=a;for(var t=0;t<a.length;t++){var n={};n.value=a[t].id,n.label=a[t].nama_karyawan,e.karyawan.push(n)}})).then((function(){e.getJabatan()})).catch((function(a){if(e.label="Tambah Karyawan",401==a.response.status)e.$store.dispatch("logout").then((function(){var a=window.location.href;a=a.split("/"),localStorage.setItem("prevPath",a[a.length-1]),e.$swal("Sesi login kamu sudah habis","login kagi yah...","warning"),setTimeout((function(){e.$swal.close(),e.$router.replace({path:"/login"})}),1500)})).catch((function(a){return e.$swal("Tidak bisa ambil data","hubungi pengembangnya...","danger"),setTimeout((function(){e.$swal.close(),e.$router.replace({path:"/login"})}),1500),!1}));else if(500==a.response.status)return e.$swal("Tidak bisa ambil data","hubungi pengembangnya...","danger"),setTimeout((function(){e.$swal.close(),e.$router.replace({path:"/login"})}),1500),!1;return!1}))},assignKaryawan:function(e){var a=this;this.user.nama=e,this.data_karyawan.forEach((function(t,n){e==t.id&&(a.user.email=t.email,fetch(localStorage.base_api+"karyawan/"+e,{method:"POST",headers:{Authorization:"bearer "+localStorage.token}}).then((function(e){return e.json()})).then((function(e){console.warn(e),a.user.id_level=e.id_jabatan})))}))},assignJabatan:function(e){this.user.id_level=e},getData:function(){var e=this,a=new Headers;a.append("Authorization","bearer "+localStorage.token);var t={method:"POST",headers:a,redirect:"follow"};Object(o["g"])(this,localStorage.base_api+"user/"+this.$route.params.id,t).then((function(a){console.warn(a),e.user=a})).catch((function(a){return e.label="Simpan Perubahan",!1}))},updateUser:function(){var e=this;if(this.errors=[],this.user.email||(this.validator.email=!1,this.validator.email_msg="Harap isi email karyawan",this.errors.push("email karyawan kosong")),!this.errors.length){this.label="Loading...";var a=new FormData;a.append("id_karyawan",this.user.id),a.append("email",this.user.email),a.append("level",this.user.id_level),this.$http.post(localStorage.base_api+"user/edit/"+this.user.id,a,{headers:{Authorization:"bearer "+localStorage.getItem("token")}}).then((function(a){e.label="Simpan Perubahan",e.$swal("Update data user berhasil","Mohon tunggu sebentar...","success"),setTimeout((function(){e.$swal.close(),e.$router.push("/user")}),1500)})).catch((function(a){for(var t in e.label="Simpan Perubahan",console.log(a),a.response.data.errmsg)console.log(a.response.data.errmsg[t][0]),e.$swal(a.response.data.errmsg[t][0],"hubungi pengembangnya yah","error"),setTimeout((function(){e.$swal.close()}),1500);return!1}))}}},created:function(){1!=localStorage.level&&2!=localStorage.level&&this.$router.push("/"),this.getKaryawan()}},s=i,l=t("2877"),u=Object(l["a"])(s,n,r,!1,null,null,null);a["default"]=u.exports},"8e44":function(e,a,t){"use strict";function n(e,a,t,n,r){return new Promise((function(o,i){e.$http.post(a,t,n).then((function(e){var a=URL.createObjectURL(new Blob([e.data],{type:"application/vnd.ms-excel"})),t=document.createElement("a");t.href=a,t.setAttribute("download",r),document.body.appendChild(t),t.click()})).then((function(){o()})).catch((function(e){i(e)}))}))}function r(){var e;return e=window.XMLHttpsRequest?new XMLHttpsRequest:new ActiveXObject("Microsoft.XMLHTTP"),e}function o(e,a,t){return new Promise((function(n,o){var i=r();i.responseType="json",i.setRequestHeader("Authorization","bearer "+localStorage.token),"withCredentials"in i?i.open("POST",e,!0):"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open("POST",e)):i=null,i||o(),i.onload=function(){var e=URL.createObjectURL(new Blob([i.response],{type:"application/vnd.ms-excel"})),a=document.createElement("a");a.href=e,a.setAttribute("download",t),document.body.appendChild(a),a.click(),n()},i.onerror=function(){o()},i.send(a)}))}function i(e,a,t,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"get";return new Promise((function(o,i){"get"==r?e.$http.get(a,t).then((function(e){var a=URL.createObjectURL(new Blob([e.data],{type:"application/pdf"})),t=document.createElement("a");t.href=a,t.setAttribute("download",n),document.body.appendChild(t),t.click()})).then((function(){o()})).catch((function(e){i(e)})):e.$http.post(a,t).then((function(e){var a=URL.createObjectURL(new Blob([e.data],{type:"application/pdf"})),t=document.createElement("a");t.href=a,t.setAttribute("download",n),document.body.appendChild(t),t.click()})).then((function(){o()})).catch((function(e){i(e)}))}))}function s(e){return new Promise((function(a,t){e.$http.get(localStorage.base_api+"po",{headers:{Authorization:"bearer "+localStorage.token}}).then((function(e){for(var a=[],t=[],n=0;n<e.data.length;n++){var r=new Date(e.data[n].date_line),o=new Date(r.setDate(r.getDate()-2));a.push({date:o,data:e.data[n],link:"po/detail/"+e.data[n].id})}for(var i=0;i<a.length;i++){var s=new Date,l=new Date(a[i].date);s==l&&t.push({date:a[i].date,data:a[i]})}return localStorage.setItem("notif",JSON.stringify(a)),a})).then((function(e){return a(e)})).catch((function(e){return t(e)}))}))}function l(e,a){return new Promise((function(t,n){var r=-1;Promise.all(e.map((function(e){return r++,fetch(e,a[r])}))).then((function(e){return Promise.all(e.map((function(e){return e.json()})))})).then((function(e){t(e)})).catch((function(e){return n(e)}))}))}function u(e,a,t,n){return new Promise((function(n,r){fetch(a,t).then((function(a){return 401==a.status?(e.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){e.$swal.close(),e.$store.dispatch("logout").then((function(){return e.$router.replace("/login")}))}),1500),!1):500==a.status?(e.$swal("Tidak bisa mengambil data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){e.$swal.close()}),1500),!1):a.json()})).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))}function c(e,a,t){return new Promise((function(n,r){fetch(a,t).then((function(a){return 401==a.status?(e.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){e.$swal.close(),e.$store.dispatch("logout").then((function(){return e.$router.replace("/login")}))}),1500),!1):500==a.status?(e.$swal("Tidak bisa menghapus data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){e.$swal.close()}),1500),!1):a.json()})).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))}t.d(a,"c",(function(){return n})),t.d(a,"d",(function(){return o})),t.d(a,"e",(function(){return i})),t.d(a,"a",(function(){return s})),t.d(a,"f",(function(){return l})),t.d(a,"g",(function(){return u})),t.d(a,"b",(function(){return c}))}}]);
//# sourceMappingURL=chunk-97571430.9d98011c.js.map