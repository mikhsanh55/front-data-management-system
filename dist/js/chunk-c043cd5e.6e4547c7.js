(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c043cd5e"],{"8e44":function(a,n,e){"use strict";function t(a,n,e,t,r){return new Promise((function(o,s){a.$http.post(n,e,t).then((function(a){var n=URL.createObjectURL(new Blob([a.data],{type:"application/vnd.ms-excel"})),e=document.createElement("a");e.href=n,e.setAttribute("download",r),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(a){s(a)}))}))}function r(a,n,e,t){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"get";return new Promise((function(o,s){"get"==r?a.$http.get(n,e).then((function(a){var n=URL.createObjectURL(new Blob([a.data],{type:"application/pdf"})),e=document.createElement("a");e.href=n,e.setAttribute("download",t),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(a){s(a)})):a.$http.post(n,e).then((function(a){var n=URL.createObjectURL(new Blob([a.data],{type:"application/pdf"})),e=document.createElement("a");e.href=n,e.setAttribute("download",t),document.body.appendChild(e),e.click()})).then((function(){o()})).catch((function(a){s(a)}))}))}function o(a){return new Promise((function(n,e){a.$http.get(localStorage.base_api+"po",{headers:{Authorization:"bearer "+localStorage.token}}).then((function(a){for(var n=[],e=0;e<a.data.length;e++){var t=(new Date).setHours(0,0,0,0),r=new Date(a.data[e].date_line);t=new Date(t),r=new Date(r.setDate(r.getDate()-2)),t.getTime()==r.getTime()&&n.push({date:r,data:a.data[e],link:"po/detail/"+a.data[e].id})}return localStorage.setItem("notif",JSON.stringify(n)),n})).then((function(a){return n(a)})).catch((function(a){return e(a)}))}))}function s(a,n){return new Promise((function(e,t){var r=-1;Promise.all(a.map((function(a){return r++,fetch(a,n[r])}))).then((function(a){return Promise.all(a.map((function(a){return a.json()})))})).then((function(a){e(a)})).catch((function(a){return t(a)}))}))}function i(a,n,e,t){return new Promise((function(t,r){fetch(n,e).then((function(n){return 401==n.status?(a.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){a.$swal.close(),a.$store.dispatch("logout").then((function(){return a.$router.replace("/login")}))}),1500),!1):500==n.status?(a.$swal("Tidak bisa mengambil data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){a.$swal.close()}),1500),!1):n.json()})).then((function(a){return t(a)})).catch((function(a){return r(a)}))}))}function l(a,n,e){return new Promise((function(t,r){fetch(n,e).then((function(n){return 401==n.status?(a.$swal("Maaf sesi login kamu sudah habis","silahkan login lagi yah...","warning"),setTimeout((function(){a.$swal.close(),a.$store.dispatch("logout").then((function(){return a.$router.replace("/login")}))}),1500),!1):500==n.status?(a.$swal("Tidak bisa menghapus data","Mohon hubungi pengembangnya...","error"),setTimeout((function(){a.$swal.close()}),1500),!1):n.json()})).then((function(a){return t(a)})).catch((function(a){return r(a)}))}))}e.d(n,"c",(function(){return t})),e.d(n,"d",(function(){return r})),e.d(n,"a",(function(){return o})),e.d(n,"e",(function(){return s})),e.d(n,"f",(function(){return i})),e.d(n,"b",(function(){return l}))},"8fb5":function(a,n,e){"use strict";var t=e("9b15"),r=e.n(t);r.a},"9b15":function(a,n,e){},f01c:function(a,n,e){"use strict";e.r(n);var t=function(){var a=this,n=a.$createElement,e=a._self._c||n;return e("div",[e("CRow",[e("CCol",{attrs:{sm:"12"}},[e("CCard",[e("CCardHeader",[e("b",[a._v("Order")]),a._v(" Barang Pesanan ")]),e("CCardBody",[e("CForm",{staticClass:"mt-4"},[e("CRow",{staticClass:"mx-auto d-flex justify-content-center"},[e("CCol",{attrs:{sm:"8"}},[e("CSelect",{attrs:{placeholder:"Pilih Barang",label:a.labelBarang,horizontal:"",options:a.barang},on:{"update:value":a.assignNamaBarang},model:{value:a.order_barang_pesanan.nama_barang,callback:function(n){a.$set(a.order_barang_pesanan,"nama_barang",n)},expression:"order_barang_pesanan.nama_barang"}}),e("CInput",{attrs:{type:"text",description:a.validator.kode_barang_msg,"is-valid":a.validator.kode_barang,autocomplete:"kode_barang",label:"Kode Barang",horizontal:"",placeholder:"Masukan Quantity",readonly:""},model:{value:a.order_barang_pesanan.kode_barang,callback:function(n){a.$set(a.order_barang_pesanan,"kode_barang",n)},expression:"order_barang_pesanan.kode_barang"}}),e("CTextarea",{attrs:{label:"Spesifikasi Barang",horizontal:"",rows:"3",readonly:""},model:{value:a.order_barang_pesanan.spesifikasi_barang,callback:function(n){a.$set(a.order_barang_pesanan,"spesifikasi_barang",n)},expression:"order_barang_pesanan.spesifikasi_barang"}}),e("CInput",{attrs:{type:"number",description:a.validator.qty_msg,"is-valid":a.validator.qty,autocomplete:"qty",label:"Quantity",horizontal:"",placeholder:"Masukan Quantity"},model:{value:a.order_barang_pesanan.qty,callback:function(n){a.$set(a.order_barang_pesanan,"qty",n)},expression:"order_barang_pesanan.qty"}}),e("CInput",{attrs:{type:"text",description:a.validator.harga_dasar_msg,"is-valid":a.validator.harga_dasar,autocomplete:"harga_dasar",label:"Harga Dasar",horizontal:"",placeholder:"Masukan harga_dasar",readonly:""},model:{value:a.order_barang_pesanan.harga_dasar,callback:function(n){a.$set(a.order_barang_pesanan,"harga_dasar",n)},expression:"order_barang_pesanan.harga_dasar"}}),e("CInput",{attrs:{type:"text",description:a.validator.satuan_msg,"is-valid":a.validator.satuan,autocomplete:"satuan",label:"Satuan",horizontal:"",placeholder:"Masukan Satuan",readonly:""},model:{value:a.order_barang_pesanan.satuan,callback:function(n){a.$set(a.order_barang_pesanan,"satuan",n)},expression:"order_barang_pesanan.satuan"}}),e("CInput",{attrs:{type:"number",description:a.validator.tax_msg,"is-valid":a.validator.tax,autocomplete:"tax",label:"Tax %",horizontal:"",placeholder:"Masukan Tax"},model:{value:a.order_barang_pesanan.tax,callback:function(n){a.$set(a.order_barang_pesanan,"tax",n)},expression:"order_barang_pesanan.tax"}}),e("CInput",{attrs:{type:"number",description:a.validator.disc_msg,"is-valid":a.validator.disc,autocomplete:"disc",label:"Disc",horizontal:"",placeholder:"Masukan disc"},model:{value:a.order_barang_pesanan.disc,callback:function(n){a.$set(a.order_barang_pesanan,"disc",n)},expression:"order_barang_pesanan.disc"}})],1),e("CCol",{staticClass:"d-flex justify-content-end mt-4",attrs:{sm:"8"}},[e("button",{staticClass:"btn btn-primary",on:{click:function(n){return n.preventDefault(),a.addToTable(n)}}},[e("i",{staticClass:"fa fa-plus mr-2"}),a._v(a._s(a.label))])])],1)],1),e("br"),e("hr",{staticClass:"text-center w-75"}),e("br"),e("CRow",[e("CCol",{attrs:{sm:"12"}},[e("v-client-table",{staticClass:"m-4",attrs:{data:a.order_barang_table,columns:a.tableFields,options:a.tableOptions,id:"request-table"},scopedSlots:a._u([{key:"aksi",fn:function(n){return e("div",{},[e("button",{staticClass:"btn btn-danger m-1",on:{click:function(e){return a.deleteFromTable(n.row.id)}}},[a._v("Hapus")])])}}])})],1)],1)],1),e("CCardFooter",{staticClass:"m-4 d-flex justify-content-end"},[e("router-link",{staticClass:"btn btn-primary",attrs:{to:"/barang-pesanan"}},[e("i",{staticClass:"fa fa-cart-plus mr-2"}),a._v(" Selesai ")])],1)],1)],1)],1)],1)},r=[],o=e("8e44"),s={name:"OrderBarangPesanan",data:function(){return{labelBarang:"Pilih Barang",label:"Tambah",errors:[],tableFields:["no","kode_barang","nama_barang","spesifikasi_barang","harga_dasar","qty","satuan","tax","disc","aksi"],tableOptions:{perPage:10,pagination:{chunk:10,dropdown:!1,edge:!0,nav:"fixed"},headings:{no:"No",kode_barang:"Kode Barang",nama_barang:"Nama Barang",spesifikasi_barang:"Spesifikasi",harga_dasar:"Harga Dasar",qty:"Qty",satuan:"Satuan",tax:"Tax (%)",disc:"Disc",aksi:"Aksi"},sortable:["no","kode_barang","nama_barang","qty"],filterable:["no","kode_barang","nama_barang","spesifikasi_barang","qty","satuan","tax","disc"],columnsClasses:{no:"text-center align-middle",kode_barang:"align-middle",nama_barang:"align-middle",spesifikasi_barang:"align-middle",harga_dasar:"text-center align-middle",qty:"text-center align-middle",satuan:"text-center align-middle",tax:"text-center align-middle",disc:"text-center align-middle",aksi:"text-center align-middle"}},barang:[],barangs:[],validator:{harga_jual:null,harga_jual_msg:null,spesifikasi_barang:null,spesifikasi_barang_msg:null,qty:null,qty_msg:null,satuan:null,satuan_msg:null},order_barang_pesanan:{id_pesanan:this.$route.params.id,id_barang:1,nama_barang:null,spesifikasi_barang:null,qty:0,tanggal:null,harga_jual:null,harga_dasar:null,status:1,kode_barang:null,tax:0,disc:0,sub_total:0,satuan:null},order_barang_table:[]}},methods:{assignNamaBarang:function(a,n){this.order_barang_pesanan.id_barang=a,this.order_barang_pesanan.nama_barang=n.target.selectedOptions[0].innerHTML;for(var e=0;e<this.barangs.length;e++)this.barangs[e].id==a&&(this.order_barang_pesanan.harga_dasar=this.barangs[e].harga_dasar,this.order_barang_pesanan.kode_barang=this.barangs[e].kode_barang,this.order_barang_pesanan.spesifikasi_barang=this.barangs[e].spesifikasi,this.order_barang_pesanan.satuan=this.barangs[e].satuan)},deleteFromTable:function(a){var n=this;this.$swal("Mohon tunggu","","info"),this.$http.delete(localStorage.base_api+"order/barang/pesanan/"+a,{headers:{Authorization:"bearer "+localStorage.token}}).then((function(a){n.order_barang_table=[],n.barangs=[],n.$swal.close(),Object(o["f"])(n,localStorage.base_api+"barang",{headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(a){n.barangs=a;for(var e=0;e<a.length;e++){var t={};t.label=a[e].nama_barang,t.value=a[e].id,n.barang.push(t)}})).catch((function(a){return console.error(a),!1})),n.getDataTable()})).catch((function(a){return n.$swal.close(),n.$swal("Tidak bisa menghapus barang","","error"),setTimeout((function(){return n.$swal.close()}),1500),!1}))},addToTable:function(){var a=this;if(this.errors=[],this.order_barang_pesanan.qty||(this.validator.qty=!1,this.validator.qty_msg="Harap isi qty barang",this.errors.push("qty kosong")),this.errors.length)return console.log(this.errors),window.scrollBy({top:-500,left:0,behavior:"smooth"}),!1;this.label="Loading...",this.order_barang_pesanan.id_po=this.$route.params.id,this.order_barang_pesanan.id_pesanan=this.$route.params.id,this.$http.post(localStorage.base_api+"order/barang/pesanan",this.order_barang_pesanan,{headers:{Authorization:"bearer "+localStorage.token}}).then((function(n){a.order_barang_table=[],a.barangs=[],a.label="Tambah",Object(o["f"])(a,localStorage.base_api+"barang",{headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(n){a.barangs=n;for(var e=0;e<n.length;e++){var t={};t.label=n[e].nama_barang,t.value=n[e].id,a.barang.push(t)}})).catch((function(a){return console.error(a),!1})),a.getDataTable(),window.scrollBy({top:1e3,left:0,behavior:"smooth"})})).catch((function(n){if(a.label="Tambah",n.response)for(var e in n.response.data.errmsg)alert(n.response.data.errmsg[e][0]);return console.error(n.response),!1}))},getDataTable:function(){var a=this;Object(o["f"])(this,localStorage.base_api+"order/barang/pesanan/detail/"+this.$route.params.id,{method:"post",headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(n){n.forEach((function(n,e){Object(o["f"])(a,localStorage.base_api+"barang/"+n.id_barang,{method:"post",headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(t){var r={id:n.id,no:++e,kode_barang:t.kode_barang,nama_barang:t.nama_barang,spesifikasi_barang:t.spesifikasi,harga_dasar:t.harga_dasar,tax:n.tax,disc:n.disc,qty:n.qty,satuan:t.satuan};a.order_barang_table.push(r)}))}))})).catch((function(n){return console.error(n),a.$swal("Tidak bisa mengambil data barang","Mohon hubungi pengembangnya","error"),setTimeout((function(){return a.$swal.close()}),1500),!1}))}},created:function(){var a=this;1!=localStorage.level&&2!=localStorage.level&&5!=localStorage.level&&this.$router.push("/"),Object(o["f"])(this,localStorage.base_api+"barang",{headers:{Authorization:"bearer "+localStorage.token}},"post").then((function(n){a.barangs=n;for(var e=0;e<n.length;e++){var t={};t.label=n[e].nama_barang,t.value=n[e].id,a.barang.push(t)}})).catch((function(a){return console.error(a),!1})),this.getDataTable()}},i=s,l=(e("8fb5"),e("2877")),d=Object(l["a"])(i,t,r,!1,null,null,null);n["default"]=d.exports}}]);
//# sourceMappingURL=chunk-c043cd5e.6e4547c7.js.map